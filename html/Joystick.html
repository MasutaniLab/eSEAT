<!DOCTYPE html>

<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html"; charset=utf-8" />
    <title>TEST: WebAdaptor for SimpleIO2</title>

    <script src="jquery-1.11.3.min.js"></script>
    <script src="jquery-migrate-1.2.1.min.js"></script>
    <script src="comet.js"></script>
    <script src="virtualjoystick.js"></script>
    <style>
	    div#topbar{
		    background-color:gray;
		    vertical-align: middle;
	    }    
	    span#title{
		    color:white;
		    font-size:18pt;
		    vertical-align: middle;
	    }    
    </style>
 
  
  </head>
  <body onLoad="long_polling_id('joystick');">
<!--
  <div id="topbar">
  <table><tr>
   <td> <img src="rtm_logo.png" /> </td>
   <td><span id="title">Test for Joystick</span></td>
   </tr>
  </table>
 </div>
-->
  <div id="result"></div>
  <div id="container" style="width:600px;height:600px;background-color:#aaaaaa"></div>
  <div>
  <script>
	var joystick	= new VirtualJoystick({
		container	: document.getElementById('container'),
		mouseSupport	: true,
		baseX		: 200,
		baseY		: 200,
	});

	var status = 0;

/*
	joystick.addEventListener('touchStart', function(){
		;
	})
*/
	joystick.addEventListener('touchEnd', function(){
		sendValueToRtc('Stop, 0, 0');
	})

	setInterval(function(){
		var outputEl	= document.getElementById('result');
		outputEl.innerHTML	= '<b>Result:</b> '
					+ ' dx:'+joystick.deltaX()
					+ ' dy:'+joystick.deltaY()
					+ (joystick.right()	? ' right'	: '')
					+ (joystick.up()	? ' up'		: '')
					+ (joystick.left()	? ' left'	: '')
					+ (joystick.down()	? ' down' 	: '');

		if(joystick._pressed){
			sendValueToRtc('Move,'+joystick.deltaY()+','+joystick.deltaX());
			status = 1;
		}else	if(status == 1){
			sendValueToRtc('Stop, 0, 0');
			status = 0;
		}

		}, 100);
  </script>
 </div>
  <div id="response"></div>
  <div id="response2"></div>

  </body>
</html>

